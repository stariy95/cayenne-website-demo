<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-144-precomposed.png" sizes="144x144" />
        <link rel="stylesheet" href="http://cayenne.apache.org/css/styles-b770de6275.css"/>
        <script src="http://cayenne.apache.org/js/bundle-736b99fdc1.js"></script>
        <title>Relationships &middot; Apache Cayenne</title>
    </head>
    <body>
<header class="page-header">
    <div class="container">
        <div class="row">
            <div class="col">
                <nav class="navbar navbar-dark navbar-expand-lg">
                    <a class="navbar-brand nav-link active" href="http://cayenne.apache.org/">Apache Cayenne</a>

                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav mr-auto">
                            
                            <li class="nav-item">
                                <a class="nav-link" href="/download/">DOWNLOAD</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="/docs/">DOCUMENTATION</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="/about/support/">SUPPORT</a>
                            </li>
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</header>








<div class="container">
    <div class="row">
        <div class="col-3">
            <div role="tabpanel">
                <ul class="nav" role="tablist">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                            Cayenne Version 3.0
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" id="cayenne-4-1-tab" href="#cayenne-4-1" role="tab" data-toggle="tab" aria-controls="cayenne-4-1" aria-expanded="true">Version 4.1 (Alpha)</a>
                            <a class="dropdown-item" id="cayenne-4-0-tab" href="#cayenne-4-0" role="tab" data-toggle="tab" aria-controls="cayenne-4-0" aria-expanded="true">Version 4.0 (Beta)</a>
                            <a class="dropdown-item" id="cayenne-3-1-tab" href="#cayenne-3-1" role="tab" data-toggle="tab" aria-controls="cayenne-3-1" aria-expanded="true">Version 3.1 (Stable)</a>
                            <a class="dropdown-item" id="cayenne-3-0-tab" href="#cayenne-3-0" role="tab" data-toggle="tab" aria-controls="cayenne-3-0" aria-expanded="true">Version 3.0 (Stable)</a>
                        </div>
                    </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                    
                    <div class="tab-pane fade " id="cayenne-4-1" role="tabpanel" aria-labelledby="cayenne-4-1-tab" aria-expanded="false">
                        
                        <li>
                            <h6><a href="/docs/4.1/getting-started-db-first/">Cayenne Database First tutorial</a></h6>
                        </li>
                        
                        <li>
                            <h6><a href="/docs/4.1/getting-started/">Cayenne Getting Started Guide</a></h6>
                        </li>
                        
                        <li>
                            <h6><a href="/docs/4.1/api/">JavaDoc</a></h6>
                        </li>
                    </div>
                    <div class="tab-pane fade " id="cayenne-4-0" role="tabpanel" aria-labelledby="cayenne-4-0-tab" aria-expanded="false">
                        
                        <li>
                            <h6><a href="/docs/4.0/getting-started/">Cayenne 4.0 Getting Started Guide</a></h6>
                        </li>
                        
                        <li>
                            <h6><a href="/docs/4.0/api/">JavaDoc</a></h6>
                        </li>
                    </div>
                    <div class="tab-pane fade " id="cayenne-3-1" role="tabpanel" aria-labelledby="cayenne-3-1-tab" aria-expanded="false">
                        
                        <li>
                            <h6><a href="/docs/3.1/api/">JavaDoc</a></h6>
                        </li>
                    </div>
                    <div class="tab-pane fade active show" id="cayenne-3-0" role="tabpanel" aria-labelledby="cayenne-3-0-tab" aria-expanded="true">
                        
                        <li>
                            <h6><a href="/docs/3.0/cayenne-guide.html">Cayenne Guide</a></h6>
                        </li>
                        
                        <li>
                            <h6><a href="/docs/3.0/modeler-guide.html">Modeler Guide</a></h6>
                        </li>
                        
                        <li>
                            <h6><a href="/docs/3.0/remote-object-persistence-guide.html">Remote Object Persistence Guide</a></h6>
                        </li>
                        
                        <li>
                            <h6><a href="/docs/3.0/api/">JavaDoc</a></h6>
                        </li>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-9">

            
            <article>
                <section>
                    <P>Relationships are special object properties that reference other &quot;related&quot; objects. Semantically there are two types of relationships - to-one pointing to just a single DataObjects (e.g. Painting.toArtist), and to-many pointing to a collection of Persistent objects of the some distinct base type (e.g. Artist.paintingArray).</P>

<H3><A name="Relationships-ToOneRelationships"></A>To-One Relationships</H3>

<P>&quot;Get&quot; methods for to-one relationships return the target Persistent object. If the object is not in memory yet, it will be fetched on first access. Modifying to-one relationships is no different from modifying attributes - just a simple call to a &quot;set&quot; method:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
Painting painting;

<SPAN class="code-comment">// obtain artist <SPAN class="code-keyword">for</SPAN> a given painting
</SPAN>Artist originalArtist = painting.getToArtist();

<SPAN class="code-comment">// replace with a <SPAN class="code-keyword">new</SPAN> artist
</SPAN>Artist newArtist = (Artist)context.newObject(Artist.class);
painting.setToArtist(newArtist);

<SPAN class="code-comment">// or remove Artist at all...
</SPAN><SPAN class="code-comment">// painting.setToArtist(<SPAN class="code-keyword">null</SPAN>);</SPAN>
</PRE>
</DIV></DIV>
<DIV class="panelMacro"><TABLE class="infoMacro"><COLGROUP><COL width="24"><COL></COLGROUP><TR><TD valign="top"><img src="/docs/3.0/images/information.gif" width="16" height="16" align="absmiddle" alt="" border="0"></TD><TD>When adding or removing an object from any kind of relationship, Cayenne will locate and modify an existing reverse relationship as appropriate.</TD></TR></TABLE></DIV>

<H3><A name="Relationships-ToManyRelationships"></A>To-Many Relationships</H3>

<P>&quot;Get&quot; methods for to-many relationships return various collections of Persistent objects. To-many relationships can be mapped as Lists (default), Collections, Sets or Maps. Below we may refer to all four types of mappings as &quot;collections&quot;, although strictly speaking Map is not a Collection in Java.</P>

<P>Just like individual Persistent objects, relationship collections are also resolved on first access (e.g. when a user tries to read an element from a collection or obtains an Iterator). For modification there are special &quot;addTo...&quot; and &quot;removeFrom...&quot; methods:</P>
<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
Artist artist;

<SPAN class="code-comment">// obtain a list of paintings
</SPAN>List paintings = artist.getPaintingArray();

<SPAN class="code-comment">// remove the first painting
</SPAN><SPAN class="code-keyword">if</SPAN>(paintings.size() &gt; 0) {
   Painting firstPainting = (Painting)paintings.get(0);
   artist.removeFromPaintingArray(firstPainting);
}

<SPAN class="code-comment">// add a <SPAN class="code-keyword">new</SPAN> painting
</SPAN>Painting newPainting = (Painting)context.newObject(Painting.class);
artist.addToPaintingArray(newPainting);
</PRE>
</DIV></DIV>

<P>Not much difference in managing Map relationships. Let's assume that Artist's paintings are modeled as a map, keyed by painting name:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
Artist artist;

<SPAN class="code-comment">// obtain a map of paintings
</SPAN>Map paintings = artist.getPaintingMap();

<SPAN class="code-comment">// lookup the painting
</SPAN>Painting girl = (Painting) paintings.get(<SPAN class="code-quote">&quot;Girl&quot;</SPAN>);

<SPAN class="code-comment">// remove the painting
</SPAN><SPAN class="code-keyword">if</SPAN>(girl != <SPAN class="code-keyword">null</SPAN>) {
   artist.removeFromPaintingMap(girl);
}

<SPAN class="code-comment">// add a <SPAN class="code-keyword">new</SPAN> painting
</SPAN>Painting newPainting = (Painting)context.newObject(Painting.class);

<SPAN class="code-comment">// must set the key property BEFORE adding to relationship
</SPAN><SPAN class="code-comment">// unless the key is object id:
</SPAN>newPainting.setName(<SPAN class="code-quote">&quot;New Painting&quot;</SPAN>);

artist.addToPaintingMap(newPainting);
</PRE>
</DIV></DIV>

<P>There's one caveat though - if an object property that is used as a map key changes, the object is remapped in the relationship only after the context is committed:</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
Painting girl = (Painting) paintings.get(<SPAN class="code-quote">&quot;Girl&quot;</SPAN>);
girl.setName(<SPAN class="code-quote">&quot;New Name&quot;</SPAN>);

...

<SPAN class="code-keyword">if</SPAN>(paintings.get(<SPAN class="code-quote">&quot;Girl&quot;</SPAN>) != <SPAN class="code-keyword">null</SPAN>) {
   <SPAN class="code-comment">// still <SPAN class="code-keyword">true</SPAN>
</SPAN>}


<SPAN class="code-keyword">if</SPAN>(paintings.get(<SPAN class="code-quote">&quot;New Name&quot;</SPAN>) != <SPAN class="code-keyword">null</SPAN>) {
   <SPAN class="code-comment">// still <SPAN class="code-keyword">false</SPAN>
</SPAN>}


...

<SPAN class="code-comment">// <SPAN class="code-keyword">this</SPAN> refreshes relationship Map keys as a side effect
</SPAN>girl.getObjectContext().commitChanges();

<SPAN class="code-keyword">if</SPAN>(paintings.get(<SPAN class="code-quote">&quot;Girl&quot;</SPAN>) != <SPAN class="code-keyword">null</SPAN>) {
   <SPAN class="code-comment">// now <SPAN class="code-keyword">false</SPAN>
</SPAN>}


<SPAN class="code-keyword">if</SPAN>(paintings.get(<SPAN class="code-quote">&quot;New Name&quot;</SPAN>) != <SPAN class="code-keyword">null</SPAN>) {
   <SPAN class="code-comment">// now <SPAN class="code-keyword">true</SPAN>
</SPAN>}

</PRE>
</DIV></DIV>


<P>Performance-wise, Maps have the most overhead of all collection options. Sets are somewhat slower than Lists or Collections (Collections are implemented as Lists internally). Considering that Cayenne Lists are internally managed as ordered Sets, and are not allowed to contain the same object more than once, you may want to avoid modeling relationships as Sets at all, unless the object public interface requirements warrant that.</P>

                </section>
            </article>

        </div>
    </div>
</div>

<footer class="page-footer">
    <div class="container">
        <div class="row">
            
            <div class="col">
                <h3 class="footer">About</h3>
                <ul class="list-unstyled">
                    
                    <li><a href="/why-cayenne.html" class="footer">Why Cayenne?</a>
                    
                    <li><a href="/download/" class="footer">Download</a>
                    
                    <li><a href="/success-stories.html" class="footer">Success Stories</a>
                    
                    <li><a href="/about/support/" class="footer">Support</a>
                    
                </ul>
            </div>
            
            <div class="col">
                <h3 class="footer">Documentation</h3>
                <ul class="list-unstyled">
                    
                    <li><a href="/docs/4.1/getting-started/" class="footer">Getting Started (4.1)</a>
                    
                    <li><a href="/docs/4.0/getting-started/" class="footer">Getting Started (4.0)</a>
                    
                    <li><a href="/docs/4.1/getting-started-db-first/" class="footer">Database First tutorial (4.1)</a>
                    
                </ul>
            </div>
            
            <div class="col">
                <h3 class="footer">Collaboration</h3>
                <ul class="list-unstyled">
                    
                    <li><a href="https://issues.apache.org/jira/browse/CAY" class="footer">Bug/Feature Tracker</a>
                    
                    <li><a href="/mailing-lists.html" class="footer">Mailing Lists</a>
                    
                    <li><a href="/dev/code-repository.html" class="footer">Code Repository</a>
                    
                    <li><a href="/dev/" class="footer">Developer Guide</a>
                    
                    <li><a href="/how-can-i-help.html" class="footer">How can I help?</a>
                    
                    <li><a href="/contributors.html" class="footer">Contributors</a>
                    
                </ul>
            </div>
            
            <div class="col">
                <h3 class="footer">News</h3>
                <ul class="list-unstyled">
                    
                    <li>
                        <div>
                            <small class="text-muted">Nov 20, 2017</small>
                        </div>
                        <a href="/2017/11/cayenne-312-released.html" class="footer">Cayenne 3.1.2 Released</a>
                    </li>
                    
                    <li>
                        <div>
                            <small class="text-muted">Oct 14, 2017</small>
                        </div>
                        <a href="/2017/10/cayenne-41m1-released.html" class="footer">Cayenne 4.1 Milestone 1 Released</a>
                    </li>
                    
                    <li>
                        <div>
                            <small class="text-muted">Oct 06, 2017</small>
                        </div>
                        <a href="/2017/10/cayenne-40B2-released.html" class="footer">Cayenne 4.0 Beta 2 Released</a>
                    </li>
                    
                    <li>
                        <div>
                            <small class="text-muted">Jun 12, 2017</small>
                        </div>
                        <a href="/2017/06/cayenne-40B1-released.html" class="footer">Cayenne 4.0 Beta 1 Released</a>
                    </li>
                    
                    <li>
                        <div>
                            <small class="text-muted">Mar 07, 2017</small>
                        </div>
                        <a href="/2017/03/cayenne-40M5-released.html" class="footer">Cayenne 4.0 Milestone 5 Released</a>
                    </li>
                    
                    <li><a href="http://cayenne.apache.org/news" class="footer">More news</a>
                </ul>
            </div>
        </div>
    </div>
    <hr class="footer">
    <div class="container">
        <div class="row">
            <div class="col"></div>
            <div class="col-8">
                <p class="text-center page-footer-copyright">
                    Copyright © 2001-2017 Apache Software Foundation. Apache Cayenne, Cayenne, Apache,
                    the Apache feather logo, and the Apache Cayenne project logo are trademarks of The Apache Software Foundation.
                    <a href="http://cayenne.apache.org/privacy-policy.html">Privacy policy</a>
                </p>
            </div>
            <div class="col"></div>
        </div>
    </div>
</footer>

    
    </body>
</html>
